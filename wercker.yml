---
box:
  id: dceoy/jupyter:latest
  entrypoint: /bin/bash -c
test:
  steps:
    - script:
        name: Install pdbio
        code: |
          pip install -U .
    - script:
        name: Validate the codes using flake8
        code: |
          find . -name '*.py' | xargs flake8 --no-isort-config
    - script:
        name: Test a command
        code: |
          set -x
          pdbio --version
          pdbio vcf2csv --sort --tsv test/example.vcf
          pdbio vcf2csv --expand-info --expand-samples test/example.vcf
          pdbio vcfsort test/example.vcf
          pdbio bed2csv --sort --tsv test/example.bed
          pdbio bed2csv --dst=/tmp/example.bed.csv test/example.bed
          pdbio bedsort test/example.bed
          pdbio sam2csv --sort --tsv test/example.sam
          pdbio sam2csv test/example.sam
          pdbio samsort --dst=/tmp/example.sorted.sam test/example.sam
  after-steps:
    - slack-notifier:
        url: $SLACK_URL
        channel: $SLACK_CHANNEL
